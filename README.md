# @ircam/sc-motion

Simple motion processing utilities.

## Install

```sh

npm install --save @ircam/sc-motion

```

## API

<!-- api -->
<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

*   [conversion][1]
    *   [Examples][2]
    *   [degreeToRadian][3]
    *   [radianToDegree][4]
    *   [g][5]
    *   [gToNewton][6]
    *   [newtonToG][7]
    *   [arrayNormaliseInPlace][8]
    *   [xyzToArray][9]
    *   [arrayToXyz][10]
    *   [alphaBetaGammaToArray][11]
    *   [arrayToAlphaBetaGamma][12]
    *   [apiConvert][13]
*   [Gravity][14]
    *   [Parameters][15]
    *   [Examples][16]
    *   [reset][17]
    *   [set][18]
    *   [process][19]

## conversion

Conversion utilities for sensor data.

### Examples

```javascript
import { xyzToArray } from '@ircam/sc-motion/conversion.js';

const accelerometer = { x: 9.81, y: 0, z: 0 };
const accelerometerArray = xyzToArray(accelerometer);
console.log({ accelerometer, accelerometerArray });
// {
//  accelerometer: { x: 9.81, y: 0, z: 0 },
//  accelerometerArray: [ 9.81, 0, 0 ]
// }
```

### degreeToRadian

Converts an angle from degrees to radians.

#### Parameters

*   `angle` **[number][20]** The angle in degrees to be converted.

Returns **[number][20]** The angle in radians.

### radianToDegree

Converts an angle from radians to degrees.

#### Parameters

*   `angle` **[number][20]** The angle in radians to be converted.

Returns **[number][20]** The angle converted to degrees.

### g

The standard acceleration due to gravity (g) in meters per second squared (m/sÂ²).

Type: [number][20]

### gToNewton

Converts a value from g-force (g) to Newtons (N).

#### Parameters

*   `force` **[number][20]** The value in g-force to be converted.

Returns **[number][20]** The equivalent value in Newtons.

### newtonToG

Converts a value from Newtons to G-force.

#### Parameters

*   `force` **[number][20]** The value in Newtons to be converted.

Returns **[number][20]** The equivalent value in G-force.

### arrayNormaliseInPlace

Normalises a 3D vector in place and returns its original magnitude.

This function modifies the input array `array` directly by dividing each of its
components by the vector's magnitude (Euclidean norm). If the magnitude is
zero, the vector remains unchanged.

#### Parameters

*   `array` **[Array][21]<[number][20]>** A 3-element array representing the 3D vector to normalise.

Returns **[number][20]** The original magnitude (Euclidean norm) of the vector.

### xyzToArray

Converts an object with x, y, and z properties into an array.

#### Parameters

*   `coordinates` **[Object][22]** The object containing x, y, and z properties.

    *   `coordinates.x` **[number][20]** The x-coordinate value.
    *   `coordinates.y` **[number][20]** The y-coordinate value.
    *   `coordinates.z` **[number][20]** The z-coordinate value.

Returns **[Array][21]<[number][20]>** An array containing the x, y, and z values in order.

### arrayToXyz

Converts an array of three numerical values into an object with `x`, `y`,
and `z` properties.

#### Parameters

*   `coordinates` **[Array][21]<[number][20]>** An array containing three numbers \[x, y, z].

    *   `coordinates.0` &#x20;
    *   `coordinates.1` &#x20;
    *   `coordinates.2` &#x20;

Returns **{x: [number][20], y: [number][20], z: [number][20]}** An object with `x`, `y`,
and `z` properties corresponding to the input array values.

### alphaBetaGammaToArray

Converts an object containing alpha, beta, and gamma properties into an array.

#### Parameters

*   `angle` **[Object][22]** The input object.

    *   `angle.alpha` **[number][20]** The alpha value.
    *   `angle.beta` **[number][20]** The beta value.
    *   `angle.gamma` **[number][20]** The gamma value.

Returns **[Array][21]<[number][20]>** An array containing the alpha, beta, and gamma values in order.

### arrayToAlphaBetaGamma

Converts an array of three elements into an object with properties alpha, beta, and gamma.

#### Parameters

*   `$0` **[Array][21]**&#x20;

    *   `$0.0` &#x20;
    *   `$0.1` &#x20;
    *   `$0.2` &#x20;
*   `angle` **[Array][21]<[number][20]>** An array containing three numeric elements \[alpha, beta, gamma].
*   `angle` **[number][20]** \[0] - The alpha value.
*   `angle` **[number][20]** \[1] - The beta value.
*   `angle` **[number][20]** \[2] - The gamma value.

Returns **{alpha: [number][20], beta: [number][20], gamma: [number][20]}** An object with properties alpha, beta, and gamma.

### apiConvert

*   **See**: inputApiValid
*   **See**: outputApiValid

Copy and converts sensor data between different API formats.

#### Parameters

*   `options` **[Object][22]** The conversion options.

    *   `options.inputApi` **[string][23]?** The input API format.
    *   `options.outputApi` **[string][23]?** The output API format.
    *   `options.accelerometer` **([Object][22] | [Array][21])?** The accelerometer data to convert.
    *   `options.gyroscope` **([Object][22] | [Array][21])?** The gyroscope data to convert.
    *   `options.gravity` **([Object][22] | [Array][21])?** The gravity data to convert.

<!---->

*   Throws **[Error][24]** If the conversion between the specified input and output APIs is unsupported.

Returns **[Object][22]** The converted sensor data. The output is a deep copy of the input
data, even if the input and output APIs are the same.

## Gravity

*   **See**: [https://w3c.github.io/accelerometer/#gravitysensor-interface][25]

Gravity class for estimating gravity using accelerometer and gyroscope.

### Parameters

*   `$0` **[Object][22]**  (optional, default `{}`)

    *   `$0.api` &#x20;
    *   `$0.gyroscopeWeightLinear`   (optional, default `0.9`)
    *   `$0.sampleRate`   (optional, default `undefined`)
*   `options` **[Object][22]** Configuration options for the Gravity instance. (optional, default `{}`)

### Examples

```javascript
import { Gravity } from '@ircam/sc-motion/gravity.js';

const gravityProcessor = new Gravity({ api: 'v3'});

let motionSensor;
let gravity;

motionSensor = {
  accelerometer: { x: 9.81, y: 0, z: 0 },
  gyroscope: { x: 0, y: 0, z: 0 },
  sampleTime: 0,
};
({ gravity } = gravityProcessor.process(motionSensor) );
console.log(gravity);
// { gravity: { x: 9.80665, y: 0, z: 0 } }

motionSensor = {
  accelerometer: { x: 4.40, y: 4.40, z: 0 },
  gyroscope: { x: -0.001, y: -0.001, z: 0 },
  sampleTime: 0.01,
};
({ gravity } = gravityProcessor.process(motionSensor) );
console.log(gravity);
// { gravity: { x: 6.934348715723057, y: 6.934348715723057, z: 0 } }
```

### reset

Resets the internal state of the Gravity instance.
Clears the last recorded sample time and resets the
accelerometer and gyroscope estimates to null.

### set

Sets the attributes of the Gravity object.

#### Parameters

*   `attributes` **[Object][22]** The attributes to be set. Same as constructor
    options.

### process

Processes accelerometer and gyroscope data to estimate gravity.

accelerometer, gyroscope and gravity conform to the `api` version specified in the constructor.

#### Parameters

*   `params` **[Object][22]** The input parameters. (optional, default `{}`)

    *   `params.accelerometer` **[Array][21]<[number][20]>** The accelerometer data, conforming to the API version.
    *   `params.gyroscope` **[Array][21]<[number][20]>** The gyroscope data, conforming to the API version.
    *   `params.sampleTime` **[number][20]?** The timestamp of the current sample in seconds.

<!---->

*   Throws **[Error][24]** Throws an error if accelerometer data is missing.
*   Throws **[Error][24]** Throws an error if gyroscope data is missing.
*   Throws **[Error][24]** Throws an error if both sample interval and sample rate are missing.

Returns **[Object][22]** An object containing the estimated gravity vector.

[1]: #conversion

[2]: #examples

[3]: #degreetoradian

[4]: #radiantodegree

[5]: #g

[6]: #gtonewton

[7]: #newtontog

[8]: #arraynormaliseinplace

[9]: #xyztoarray

[10]: #arraytoxyz

[11]: #alphabetagammatoarray

[12]: #arraytoalphabetagamma

[13]: #apiconvert

[14]: #gravity

[15]: #parameters-10

[16]: #examples-1

[17]: #reset

[18]: #set

[19]: #process

[20]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[21]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[22]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[23]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[24]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error

[25]: https://w3c.github.io/accelerometer/#gravitysensor-interface

<!-- apistop -->

## License

[BSD-3-Clause](./LICENSE)
